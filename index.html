
<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>System Terminal</title>
  <style>
    :root {
      --bg: #0a0f0a;
      --fg: #b6f7b6;
      --accent: #2af02a;
      --muted: #6f996f;
      --error: #ff4d4d;
    }
    html, body { height: 100%; background: var(--bg); color: var(--fg); margin: 0; }
    body { font-family: "Consolas","Courier New",monospace; }
    .screen {
      max-width: 900px; margin: 0 auto; padding: 16px;
      box-sizing: border-box; min-height: 100%;
    }
    .title { color: var(--accent); letter-spacing: 0.1em; margin-bottom: 8px; }
    .bar { height: 1px; background: var(--accent); opacity: .4; margin: 8px 0 16px; }
    .line { white-space: pre-wrap; }
    .cursor {
      display: inline-block; width: 10px; background: var(--accent);
      animation: blink 1s steps(1, start) infinite;
      margin-left: 4px; height: 1em; vertical-align: text-bottom;
    }
    @keyframes blink { 50% { opacity: 0; } }
    .input-row { display: flex; gap: 8px; align-items: center; margin-top: 6px; }
    .prompt { color: var(--accent); }
    input[type="text"], input[type="password"] {
      background: #0e120e; border: 1px solid #214621; color: var(--fg);
      padding: 8px 10px; font: inherit; width: 100%;
      outline: none;
    }
    button {
      background: #183c18; color: var(--fg); border: 1px solid #2b6c2b;
      padding: 8px 12px; font: inherit; cursor: pointer;
    }
    button:hover { filter: brightness(1.1); }
    .muted { color: var(--muted); }
    .error { color: var(--error); }
    .progress {
      width: 100%; height: 10px; background: #0e120e; border: 1px solid #214621; margin: 8px 0 12px;
      position: relative;
    }
    .progress > span {
      display: block; height: 100%; width: 0%; background: var(--accent);
      transition: width .5s ease;
    }
    .scan-label { font-size: 0.9em; color: var(--muted); margin-top: -4px; margin-bottom: 8px; }
    /* Matrix-rain header (optioneel flair) */
    canvas { display: block; width: 100%; height: 120px; background: transparent; margin-bottom: 8px; }
  </style>
</head>
<body>
  <div class="screen" id="screen">
    <canvas id="matrix"></canvas>
    <div class="title">[ ACCESS PORT : COM-TERM v3.9 ]</div>
    <div class="bar"></div>
    <div id="output" aria-live="polite"></div>
    <div id="inputs"></div>
  </div>

  <script>
    // ==========================
    //  CONFIG â€“ PAS HIER AAN
    // ==========================
    const VALID = {
      // Naam moet "Brenda" zijn (case-insensitief toegestaan via allowList).
      naamAllowList: ["Brenda"],
      // Eventueel kun je i.p.v. exact Ã©Ã©n naam ook meerdere varianten toelaten:
      // naamAllowList: ["Brenda", "Bren", "B."]
      codeExact: "SANTA-2025",    // <-- pas aan of gebruik codeRegex
      codeRegex: null             // voorbeeld: /^\d{4}$/ voor 4 cijfers
    };

    // Je eindboodschap personaliseren:
    function finalMessage(state) {
      return `Hey ${state.naam}, jouw cadeau ligt onder de boom, derde van links. 
Scan afgerond met code: ${state.code}. 
Fijne feestdagen! ðŸŽ„`;
    }

    // ==========================
    //  TERMINAL ENGINE
    // ==========================
    const output = document.getElementById('output');
    const inputs = document.getElementById('inputs');
    const state = { naam: null, code: null };

    async function typeLine(text, cls="line", speedMin=15, speedRand=30) {
      const line = document.createElement('div');
      line.className = cls;
      output.appendChild(line);

      const content = typeof text === "function" ? text(state) : String(text);
      let i = 0;
      return new Promise(resolve => {
        const cursor = document.createElement('span');
        cursor.className = 'cursor';
        line.appendChild(cursor);

        (function tick() {
          if (i < content.length) {
            cursor.insertAdjacentText('beforebegin', content[i++]);
            setTimeout(tick, Math.random()*speedRand + speedMin);
          } else {
            cursor.remove();
            resolve();
          }
        })();
      });
    }

    function addProgress(label = "") {
      const p = document.createElement('div'); p.className = 'progress';
      const s = document.createElement('span'); p.appendChild(s);
      output.appendChild(p);

      if (label) {
        const l = document.createElement('div');
        l.className = 'scan-label';
        l.textContent = label;
        output.appendChild(l);
      }

      let val = 0;
      const id = setInterval(() => {
        val = Math.min(100, val + Math.random()*20 + 10);
        s.style.width = val + "%";
        if (val >= 100) clearInterval(id);
      }, 300);
      // Houd de progress ~2.2s bezig
      return new Promise(res => setTimeout(res, 2200));
    }

    function askInput(cfg) {
      return new Promise(resolve => {
        const row = document.createElement('div'); row.className = 'input-row';
        const prompt = document.createElement('span'); prompt.className = 'prompt'; prompt.textContent = `> ${cfg.label}:`;
        const field = document.createElement('input'); field.type = cfg.type || 'text'; field.placeholder = cfg.placeholder || '';
        const btn = document.createElement('button'); btn.textContent = cfg.button || 'OK';
        row.append(prompt, field, btn);
        inputs.appendChild(row);
        field.focus();

        const finish = () => {
          const val = field.value.trim();
          if (!val) return;
          const echo = document.createElement('div'); echo.className = 'line muted';
          echo.textContent = `> ${cfg.label} = ${cfg.type === 'password' ? '****' : val}`;
          output.appendChild(echo);
          inputs.removeChild(row);
          resolve(val);
        };
        btn.addEventListener('click', finish);
        field.addEventListener('keydown', e => { if (e.key === 'Enter') finish(); });
      });
    }

    async function showError(msg) {
      await typeLine(`ERROR: ${msg}`, "line error");
    }

    function isValidName(name) {
      if (!name) return false;
      const n = name.trim().toLowerCase();
      if (Array.isArray(VALID.naamAllowList)) {
        return VALID.naamAllowList.some(v => v.toLowerCase() === n);
      }
      return false;
    }

    function isValidCode(code) {
      if (!code) return false;
      if (VALID.codeRegex instanceof RegExp) return VALID.codeRegex.test(code);
      if (VALID.codeExact) return code === VALID.codeExact;
      return false;
    }

    // ==========================
    //  SCRIPT â€“ LANGE VERSIE MET â€œSCANSâ€
    // ==========================
    async function runScript() {
      await typeLine("Boot sequence initiated...");
      await typeLine("Loading modules: [core] [net] [ui] [crypto]");
      await typeLine("Performing integrity check...");
      await typeLine(":: OK");
      await typeLine("Establishing secure channel...");
      await typeLine("Channel established (AES-256/GCM)");

      // Scan 1: QR payload
      await typeLine("Scanning QR payload...");
      await addProgress("Verifieert QRâ€‘gegevens en checksum");
      await typeLine("Payload verified.");

      // Scan 2: Omgevingsscan
      await typeLine("Running environment diagnostics...");
      await addProgress("Controleert apparaat, klok, weergave, netwerk");
      await typeLine("Environment stable.");

      // Scan 3: Parcel manifest
      await typeLine("Decrypting parcel manifest...");
      await addProgress("Zoekt naar kerstgevoelâ€¦");
      await typeLine("Kerstgevoel gevonden.");

      await typeLine("Welkom Agent. ðŸŽ„");
      await typeLine("Voer je naam in om door te gaan.");

      // NAAM (moet Brenda zijn)
      while (true) {
        const naam = await askInput({ id: "naam", label: "naam", type: "text", placeholder: "Jouw naam", button: "Verder" });
        if (isValidName(naam)) { state.naam = naam; break; }
        await showError("Onbekende agentnaam. Toegang geweigerd.");
        await typeLine("Probeer opnieuw: juiste naam vereist (tip: check je label).");
      }

      await typeLine("Identiteit geverifieerd. âœ…");

      // Extra scan na identity (voor effect)
      await typeLine("Linking identity to parcel manifestâ€¦");
      await addProgress("Controleert of je wel braaf bent geweestâ€¦");
      await typeLine("Goedgekeurd.");

      // CODE
      await typeLine("Voer de geheime code in die bij je cadeau hoort.");
      let attempts = 0, MAX_ATTEMPTS = 3;
      while (true) {
        const code = await askInput({ id: "code", label: "code", type: "password", placeholder: "****", button: "Valideer" });
        if (isValidCode(code)) { state.code = code; break; }
        attempts++;
        await showError(`Ongeldige of verlopen code. Poging ${attempts}/${MAX_ATTEMPTS}.`);
        if (attempts >= MAX_ATTEMPTS) {
          await typeLine("Sessie vergrendeld wegens te veel foute pogingen. ðŸ”’");
          await typeLine("Neem contact op met de Kerstâ€‘Operaties.");
          return;
        }
        await typeLine("Hint: check het label op je pakje en probeer opnieuw.");
      }

      // Laatste verificatie-scan
      await typeLine("Final authorization checksâ€¦");
      await addProgress("Bevestigt code, agentâ€‘ID en itemâ€‘locatie");
      await typeLine("Authorization success.");

      // EIND
      await typeLine("Toegang verleend. ðŸŽ");
      await typeLine(finalMessage);
      await typeLine("Sluit dit scherm niet. Volg de instructies op het pakje. Veel plezier!");
    }

    // ==========================
    //  MATRIX RAIN (FLAIR)
    // ==========================
    function matrixRain() {
      const canvas = document.getElementById('matrix');
      const ctx = canvas.getContext('2d');
      const resize = () => {
        canvas.width = canvas.clientWidth;
        canvas.height = canvas.clientHeight;
      };
      window.addEventListener('resize', resize);
      resize();

      const letters = "01$#@*";
      const fontSize = 16;
      let columns = Math.floor(canvas.width / fontSize);
      let drops = Array(columns).fill(1);

      function draw() {
        ctx.fillStyle = "rgba(10, 15, 10, 0.08)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = getComputedStyle(document.documentElement)
          .getPropertyValue('--accent');
        ctx.font = fontSize + "px Consolas";
        for (let i = 0; i < drops.length; i++) {
          const text = letters[Math.floor(Math.random() * letters.length)];
          ctx.fillText(text, i * fontSize, drops[i] * fontSize);
          if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
            drops[i] = 0;
          }
          drops[i]++;
        }
        requestAnimationFrame(draw);
      }
      draw();
    }

    matrixRain();
    runScript();
  </script>
</body>
</html>

